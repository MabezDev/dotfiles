#!/bin/bash

i3_path="i3/.config/i3/"
zsh_path="zsh/.zsh_conf"

hname=$(hostname)
os=$(uname -s)

case "${os}" in
    Linux*)     pre_linux;;
    Darwin*)    pre_macos;;
    *)          echo "Unknown OS"; exit 1
esac

pre_linux() {
	# prepare dunst
	mkdir -p .config/dunst/

	# merge i3 config with chosen
	cat $i3_path/config.base > $i3_path/config

	# append per pc config
	cat $i3_path/config.$hname >> $i3_path/config
}

pre_macos() {
	# nop
}

# check if pretzo is installed, if not, install it now
[ ! -d "${ZDOTDIR:-$HOME}/.zprezto" ] && git clone --recursive https://github.com/sorin-ionescu/prezto.git "${ZDOTDIR:-$HOME}/.zprezto"

# configure and install zsh configs
cat $zsh_path/zshenv.all > zsh/.zshenv
cat $zsh_path/zshenv.$hname >> zsh/.zshenv


# TODO link with `dot` instead!
# find . -maxdepth 1 -name "[!.]*" -type d -exec bash -c 'stow -R $(basename "$0")' {} \;

case "${os}" in
    Linux*)     post_linux;;
    Darwin*)    post_macos;;
    *)          echo "Unknown OS"; exit 1
esac

post_linux() {
	$HOME/.config/rofi/themeswitch.sh island-flow.png
	i3-msg restart
}

post_macos() {

}